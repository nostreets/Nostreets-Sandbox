<div>
    <div class="row text-center">
        <a class="text-blueish">View Code</a>
    </div>
    <div class="row">
        <h2 class="text-center text-primary text-blueish">Bill Manager</h2>
        <ul class="nav nav-tabs nav-justified">
            <li role="presentation" class="active"><a class="assetSwitcher" role="tab" data-target="#incomeTab" data-toggle="tab" ng-click="pg.changeCurrentTab('income')">Incomes</a></li>
            <li role="presentation"><a class="assetSwitcher" role="tab" data-target="#combinedTab" data-toggle="tab" ng-click="pg.changeCurrentTab('combined')">Incomes & Expenses</a></li>
            <li role="presentation"><a class="assetSwitcher" role="tab" data-target="#expenseTab" data-toggle="tab" ng-click="pg.changeCurrentTab('expense')">Expenses</a></li>
        </ul>
        <!--<div class="ui top attached tabular menu">
            <a class="item active" data-tab="income" ng-click="pg.changeCurrentTab('income')">Incomes</a>
            <a class="item" data-tab="combined" ng-click="pg.changeCurrentTab('combined')">Incomes & Expenses</a>
            <a class="item" data-tab="expense" ng-click="pg.changeCurrentTab('expense')">Expenses</a>
        </div>-->
    </div>

    <div class="row">
        <div class="col-sm-4 col-sm-offset-1 text-center" style="margin-top: 2%">
            <strong style="color: rgb(167, 164, 191)">Beginning Date:</strong>
            <div class="input-group">
                <input type="datetime" uib-datepicker-popup ng-model="pg.beginDate" ng-change="pg.updateChart()" class="form-control well well-sm text-center" is-open="pg.isStart" close-text="Close" />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-xs btn-simple" ng-click="pg.openDatePicker('start')"><i class="glyphicon glyphicon-calendar"></i></button>
                </span>
            </div>
        </div>
        <div class="col-sm-2 text-center" style="margin: 3% 0% 3% 0%;">
            <select ng-if="pg.chartType == 'line'" ng-change="pg.updateChart()" ng-model="pg.chartLineStyle">
                <option value="none">None</option>
                <option value="smooth">Smooth</option>
                <option value="step">Step</option>
            </select>
        </div>
        <div class="col-sm-4 col-sm-offset-1 text-center" style="margin-top: 2%">
            <strong style="color: rgb(167, 164, 191)">Ending Date:</strong>
            <div class="input-group">
                <input type="datetime" uib-datepicker-popup ng-model="pg.endDate" ng-change="pg.updateChart()" class="form-control well well-sm text-center" is-open="pg.isEnding" close-text="Close" />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-xs btn-simple" ng-click="pg.openDatePicker('end')"><i class="glyphicon glyphicon-calendar"></i></button>
                </span>
            </div>
        </div>
    </div>

    <div class="row">
        <div align="center">
            <button class="btn btn-xs btn-round" ng-if="pg.currentTab !== 'combined'" ng-click="pg.openInsertModal()">Add {{ pg.currentTab == "income" ? "Income" : "Expense" }}</button>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="card" style="padding-bottom: 2%;">
                <div class="card-header">
                    <button data-toggle="tab" role="tab" class="btn btn-simple pull-right" ng-click="pg.openInsertModal()">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                    </button>
                    <ul class="nav nav-tabs nav-justified tabs-basic">
                        <li role="presentation" class="active">
                            <a role="tab" data-target="#assetsTab" data-toggle="tab">{{ (pg.currentTab == 'income') ? 'Incomes' : (pg.currentTab == 'expense') ? 'Expenses' : 'Incomes & Expenses' }}</a>
                        </li>
                        <li role="presentation">
                            <a role="tab" data-target="#totalsTab" data-toggle="tab">Totals</a>
                        </li>
                    </ul>
                </div>
                <div class="card-content text-center">
                    <!--<img src="/assets/css/default-skin/preloader.gif"/>-->
                    <div class="tab-content">
                        <div id="assetsTab" class="active tab-pane fade in" role="tabpanel">
                            <div ng-repeat="item in pg.legend">
                                <div class="col-xs-12 text-center">
                                    <div class="col-sm-1">
                                        <color-picker ng-model="item.style.color"
                                                      event-api="pg.cpEventApi"
                                                      options="pg.cpOptions">

                                        </color-picker>
                                    </div>

                                    <div class="col-sm-6 col-sm-push-6">
                                        <div class="btn-group btn-group-xs btn-group-toggle" data-toggle="buttons">
                                            <button class="btn btn-round"
                                                    style="background-color: #d1b100"
                                                    ng-click="pg.openInsertModal(item)">
                                                Edit
                                            </button>
                                            <button class="btn btn-round"
                                                    ng-class="{'btn-toggle0': !item.isHiddenOnChart, 'btn-toggle1': item.isHiddenOnChart }"
                                                    ng-click="pg.toggleVisiblity(item)">
                                                {{ (item.isHiddenOnChart === false) ? 'Hide' : 'Show' }}
                                            </button>
                                            <button class="btn btn-round"
                                                    style="background-color: #CB2A2A"
                                                    ng-click="pg.deleteAsset(item)">
                                                X
                                            </button>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-xs-12 text-center">
                                    <h4>{{ item.name }}</h4>
                                    <div>
                                        {{ (item.incomeType) ? '+' :  '-' }}
                                        {{ item.cost | currency }}
                                        {{ item.rate === 3 ? 'Per Year' : item.rate === 5 ? 'Per Month' : item.rate === 7 ? 'Per Week' : item.rate === 9 ? 'Per Hour' : item.rate === 8 ? 'Per Day' : '' }}
                                    </div>

                                    <small>
                                        Income Type: {{ (item.incomeType) ? pg.enums.income[item.incomeType] : pg.enums.expense[item.expenseType] }}
                                    </small>
                                    <br />
                                    <small>
                                        {{ (item.incomeType) ? 'Paycheck ' : 'Payment ' }} Frequency: {{  pg.enums.schedule[item.paySchedule] }}
                                    </small>
                                    <br />
                                    <small>
                                        Date Paid: {{ (item.paySchedule == 3 || item.paySchedule == 4) ? ((item.timePaid | date:'MMMM d') + pg.dateEnding(item.timePaid)) :  (item.paySchedule == 6 || item.paySchedule == 7) ? (item.timePaid | date:'EEEE') : (item.paySchedule == 8 || item.paySchedule == 9) ? (item.timePaid | date:'h:mma') : (item.paySchedule == 5) ? ((item.timePaid | date:'d') + pg.dateEnding(item.timePaid)) : (item.timePaid | date:'longDate') }}
                                    </small>
                                </div>
                            </div>
                        </div>


                        <div id="totalsTab" class="tab-pane fade" role="tabpanel">
                            <div>
                                <div class="row" ng-repeat="item in pg.totals">
                                    <div class="col-xs-offset-1 col-xs-2"><h4>{{ item.date }}</h4></div>
                                    <div class="col-xs-10" ng-repeat="cost in item.costs">
                                        {{ cost.name + ': ' + ((cost.cost > 0) ? '+' : '') + (cost.cost | currency) }}
                                    </div>
                                </div>
                                <br />
                                <div class="col-xs-12 col-xs-offset-2">
                                    Overall Amount: {{ ((pg.overallCost > 0) ? '+' : '') + (pg.overallCost | currency) }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script type="text/ng-template" id="modalExpenseBuilder.html">
    <div class="card modal-body">
        <form name="form" novalidate>
            <div class="card-content">
                <div class="row" align="center">
                    <div class="col-xs-1">
                        <color-picker ng-model="mc.style.color" api="mc.cpApi" options="mc.cpOptions"></color-picker>
                    </div>
                </div>
                <div class="row" align="center">
                    <div class="row" style="margin-bottom: 2%;">
                        <div class="col-sm-6">
                            <div><strong>{{ mc.type == "income" ? "Income" : "Expense" }} Name:</strong></div>
                            <input type="text" class="input-sm" required ng-model="mc.name" />
                        </div>
                        <div class="col-sm-3">
                            <div><strong>{{ mc.type == "income" ? "Pay" : "Cost" }}:</strong></div>
                            <input type="number" class="input-sm" required ng-model="mc.cost" />
                        </div>
                        <div class="col-sm-3">
                            <div><strong>Rate:</strong></div>
                            <select ng-model="mc.rate">
                               <option ng-repeat="option in mc.availableEnums('rate')" value="{{option.value}}">{{option.label}}</option>
                                
                                <!--<option value="2">Once</option>
                                <option value="3" ng-if="mc.paySchedule != '3' && mc.paySchedule != '4' && mc.paySchedule != '5' && mc.paySchedule != '6' && mc.paySchedule != '7' && mc.paySchedule != '8'">Per Year</option>
                                <option value="6" ng-if="mc.paySchedule != '5' && mc.paySchedule != '6' && mc.paySchedule != '7' && mc.paySchedule != '8'">Per Month</option>
                                <option value="9" ng-if="mc.paySchedule != '7' && mc.paySchedule != '8'">Per Week</option>
                                <option value="10" ng-if="mc.paySchedule != '8'">Per Day</option>
                                <option value="11">Per Hour</option>-->
                            </select>
                        </div>
                    </div>
                    <div class="row" style="margin-bottom: 2%;">
                        <div ng-class="{'col-sm-6': mc.rate === '2', 'col-sm-3': mc.rate !== '2'}">
                            <div><strong>{{ mc.type == "income" ? "Income" : "Expense" }} Type:</strong></div>
                            <select ng-if="mc.type == 'income'" ng-model="mc.incomeType">

                                <option ng-repeat="option in mc.availableEnums('incomeType')" value="{{option.value}}">{{option.label}}</option>

                                <!--<option value="1">Paycheck</option>
                                <option value="2">Residual</option>
                                <option value="3">Product</option>
                                <option value="4">Personal</option>-->
                            </select>
                            <select ng-if="mc.type != 'income'" ng-model="mc.expenseType">

                                <option ng-repeat="option in mc.availableEnums('expenseType')" value="{{option.value}}">{{option.label}}</option>

                                <!--<option value="1">Shelter</option>
                                <option value="2">Food</option>
                                <option value="3">Travel</option>
                                <option value="4">Educational</option>
                                <option value="5">Utilities</option>
                                <option value="6">Entertaiment</option>
                                <option value="7">Recreational</option>
                                <option value="8">Investment</option>
                                <option value="9">Other</option>-->
                            </select>
                        </div>
                        <div ng-class="{'col-sm-6': mc.rate === '2', 'col-sm-3': mc.rate !== '2'}">
                            <div><strong>{{ (mc.type === 'income') ? 'Paycheck' : 'Payment' }} Frequency:</strong></div>
                            
                            <select ng-model="mc.paySchedule">
                            
                                <option ng-repeat="option in mc.availableEnums('frequency')" value="{{option.value}}">{{option.label}}</option>

                                <!--<option value="1">Occasionally</option>
                                <option value="2">Once</option>
                                <option value="3">Yearly</option>
                                <option value="4">Bi-Yearly</option>
                                <option value="5">Monthly</option>
                                <option value="6">Bi-Weekly</option>
                                <option value="7">Weekly</option>
                                <option value="11">Daily</option>-->
                                <!--<option value="9">Hourly</option>-->
                            </select>
                        </div>
                        <div ng-if="mc.rate != '2'" class="col-sm-6">
                            <div>
                                <strong>
                                    Number of  Paid
                                    {{ (mc.rate === '9') ? 'Hours' : (mc.rate === '8') ? 'Days' : (mc.rate === '7') ? 'Weeks' : (mc.rate === '5') ? 'Months' : 'Years' }}
                                    {{ (mc.paySchedule === '1') ? 'Per Occasion' : (mc.paySchedule === '3') ? 'Per Year' : (mc.rate === '4') ? 'Every 6 Months' : (mc.paySchedule === '5') ? 'Per Month' : (mc.paySchedule === '6') ? 'Every Other Week' : (mc.paySchedule === '7') ? 'Per Week' : (mc.paySchedule === '8') ? 'Per Day' : '' }}:
                                </strong>
                            </div>
                            <input class="input-sm" ng-model="mc.rateMultilplier" type="number" />
                        </div>
                    </div>
                    <div class="row" style="margin-bottom: 4%;">
                        <div class="input-group" align="center">
                            <span><strong>Pay Date:</strong></span>
                            <input type="datetime" uib-datepicker-popup ng-model="mc.timePaid" class="form-control well well-sm" is-open="mc.isTimePaidOpen" close-text="Close" />
                            <span class="input-group-btn">
                                <button type="button" class="btn btn-xs btn-simple" ng-click="mc.openDatePicker('timePaid')"><i class="glyphicon glyphicon-calendar" style="color:black"></i></button>
                            </span>
                        </div>
                        <!--<div class="col-sm-4">
                            <div class="input-group">
                                <span><strong>Beginning Pay Date:</strong></span>
                                <input type="text" uib-datepicker-popup ng-model="mc.beginDate" class="form-control well well-sm" is-open="mc.isBeginDateOpen" close-text="Close" />
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-xs btn-simple" ng-click="mc.openDatePicker('beginDate')"><i class="glyphicon glyphicon-calendar" style="color:black"></i></button>
                                </span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="input-group">
                                <span><strong>Endding Pay Date:</strong></span>
                                <input type="text" uib-datepicker-popup ng-model="mc.endDate" class="form-control well well-sm" is-open="mc.isEndDateOpen" close-text="Close" />
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-xs btn-simple" ng-click="mc.openDatePicker('endDate')"><i class="glyphicon glyphicon-calendar" style="color:black"></i></button>
                                </span>
                            </div>
                        </div>-->
                    </div>
                    <div class="row">
                        <div class="btn-group btn-group-xs">
                            <button class="btn btn-round"
                                    ng-disabled="!mc.name || !mc.type || !mc.paySchedule || !mc.timePaid"
                                    ng-click="mc.submit()"
                                    style="background-color: #58AA42">
                                {{ ((mc.id !== 0) ? 'Update' : 'Add') + ' ' + ((mc.type == "income") ? "Income" : "Expense") }}!
                            </button>
                            <button class="btn btn-round" style="background-color: #d1b100" ng-click="mc.reset()">
                                Reset!
                            </button>
                            <button class="btn btn-round"
                                    ng-class="{'btn-toggle0': !item.isHiddenOnChart, 'btn-toggle1': item.isHiddenOnChart }"
                                    ng-click="mc.toggleVisiblity(item)">
                                {{ (mc.isHiddenOnChart === false) ? 'Hide' : 'Show' }}
                            </button>
                            <button style="background-color: #CB2A2A" class="btn btn-round" ng-click="mc.cancel()">
                                Cancel
                            </button>

                        </div>

                        
                    </div>
                </div>
            </div>
        </form>
    </div>
</script>